<div>
  <mat-table #table [dataSource]="alertHistory">
  <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>

  <ng-container matColumnDef="alertType">
    <mat-header-cell *matHeaderCellDef>Alert type</mat-header-cell>
    <mat-cell *matCellDef="let alert">
      <div [ngSwitch]="alert.alertType">
        <span *ngSwitchCase="AlertType.AWAY">AWAY</span>
        <span *ngSwitchCase="AlertType.STAY">STAY</span>
        <span *ngSwitchCase="AlertType.SABOTAGE">SABOTAGE</span>
      </div>
    </mat-cell>
  </ng-container>

  <ng-container matColumnDef="startTime">
    <mat-header-cell *matHeaderCellDef>Start time</mat-header-cell>
    <mat-cell *matCellDef="let alert"> {{alert.startTime}} </mat-cell>
  </ng-container>

  <ng-container matColumnDef="endTime">
    <mat-header-cell *matHeaderCellDef>End time</mat-header-cell>
    <mat-cell *matCellDef="let alert"> {{alert.endTime}} </mat-cell>
  </ng-container>

  <ng-container matColumnDef="sensors">
    <mat-header-cell *matHeaderCellDef>Sensors</mat-header-cell>
    <mat-cell *matCellDef="let alert">
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>Sensor(s)</mat-panel-title>
          <mat-panel-description>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <div *ngFor="let sensor of alert.sensors">
          <div *ngIf="sensors && sensorExists(sensor.id); else sensor_doesnt_exists">
            <a [routerLink]="['/sensors']" fragment="sensor-{{sensor.id}}">{{sensor.description}}</a> (Channel: {{sensor.channel}})
          </div>
          <ng-template #sensor_doesnt_exists>
            {{sensor.description}} (Channel: {{sensor.channel}})
          </ng-template>
        </div>
      </mat-expansion-panel>
    </mat-cell>
  </ng-container>

  <mat-row *matRowDef="let alert; columns: displayedColumns;" [ngClass]="{'ongoing-alert': !alert.endTime}"></mat-row>
  </mat-table>
</div>