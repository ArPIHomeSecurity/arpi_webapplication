<div class="container">
  <mat-card *ngIf="location" class="container-item zone-form">
    <mat-card-content>
      <form [formGroup]="locationForm" (ngSubmit)="onSubmit()">
        <div class="column">
          <mat-form-field>
            <mat-label i18n="@@location name">Name</mat-label>
            <input matInput type="text" class="form-control" maxlength="16" formControlName="name">
          </mat-form-field>

          <div class="row">
            <mat-form-field class="domain">
              <mat-label i18n="@@location primary domain">Primary Domain</mat-label>
              <input matInput type="text" autocapitalize="off" class="form-control" name="primaryDomain"
                formControlName="primaryDomain" (change)="onFieldChange($event)">
              <mat-hint *ngIf="showApiLink && testResult?.primary === false">
                <a href="https://{{location.primaryDomain}}:{{location.primaryPort}}/api/version" target="_blank"><span
                    i18n="@@location check" class="no-wrap">Check API version and
                    certificate</span><mat-icon>open_in_new</mat-icon></a>
              </mat-hint>
            </mat-form-field>

            <mat-form-field class="port">
              <mat-label i18n="@@location port">Port</mat-label>
              <input matInput type="number" class="form-control" name="primaryPort" formControlName="primaryPort"
                (change)="onFieldChange($event)">
            </mat-form-field>

            <div *ngIf="testResult !== null" class="status">
              <mat-icon *ngIf="testResult.primary === true" class="icon-accessible">check_circle</mat-icon>
              <mat-icon *ngIf="testResult.primary === false" class="icon-inaccessible">error</mat-icon>
              <mat-spinner *ngIf="testResult.primary === null" diameter="16" />
            </div>
          </div>

          <div class="row">
            <mat-form-field class="domain">
              <mat-label i18n="@@location secondary domain">Secondary Domain</mat-label>
              <input matInput type="text" autocapitalize="off" class="form-control" name="secondaryDomain"
                formControlName="secondaryDomain" (change)="onFieldChange($event)">
              <mat-hint *ngIf="showApiLink && testResult?.secondary === false">
                <a href="https://{{location.secondaryDomain}}:{{location.secondaryPort}}/api/version"
                  target="_blank"><span i18n="@@location check" class="no-wrap">Check API version and
                    certificate</span><mat-icon>open_in_new</mat-icon></a>
              </mat-hint>
            </mat-form-field>

            <mat-form-field class="port">
              <mat-label i18n="@@location port">Port</mat-label>
              <input matInput type="number" class="form-control" name="secondaryPort" formControlName="secondaryPort"
                (change)="onFieldChange($event)">
            </mat-form-field>

            <div *ngIf="testResult !== null" class="status">
              <mat-icon *ngIf="testResult.secondary === true" class="icon-accessible">check_circle</mat-icon>
              <mat-icon *ngIf="testResult.secondary === false" class="icon-inaccessible">error</mat-icon>
              <mat-spinner *ngIf="testResult.secondary === null" diameter="16" />
            </div>
          </div>
        </div>
      </form>
    </mat-card-content>

    <mat-divider></mat-divider>

    <mat-card-content class="details">
      <dl>
        <dt *ngIf="location.id" i18n="@@location id">ID:</dt>
        <dd *ngIf="location.id">{{location.id}}</dd>
        <dt *ngIf="version" i18n="@@location version">Version:</dt>
        <dd *ngIf="version">{{version}}</dd>
      </dl>
      <div *ngIf="location.id != null">
        <span *ngIf="isRegistered() === true">
          <span i18n="@@location device registered">Device registered</span>
        </span>
        <span *ngIf="isRegistered() === false">
          <span i18n="@@location device not registered">Device NOT registered</span>
        </span>
      </div>
      <app-message *ngIf="alreadyExists() && newLocation" type="warning" [message]="ALREADY_EXISTS"></app-message>
    </mat-card-content>

    <mat-divider></mat-divider>

    <mat-card-actions align="end">
      <button mat-icon-button color="primary" (click)="executeLocationTest()" [disabled]="locationForm.invalid">
        <mat-icon>search</mat-icon>
      </button>
      <button mat-icon-button color="primary" (click)="onSubmit()"
        [disabled]="cantSave()"><mat-icon>save</mat-icon></button>
      <button mat-icon-button color="warn" type="button" (click)="openDeleteDialog()"
        [disabled]="selectedLocationId === location.id || location.id == null"><mat-icon>delete</mat-icon></button>
      <button mat-icon-button color="accent" type="button" (click)="onCancel()"><mat-icon>cancel</mat-icon></button>
    </mat-card-actions>

  </mat-card>

  <div *ngIf="location == null" class="container-item">
    <h1 i18n="@@location not found">The location was not found!</h1>
  </div>
</div>